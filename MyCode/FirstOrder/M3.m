function res = M3(j,h,c)
%%Amplified by 21600h^2
%h=1/(1+length(qList));
m3L1=0;
m3R2=0;
if (j>1)
    m3L1=M31l1(j,h,c)+M32l1(j,h,c);
end
m3L2=M31l2(j,h,c)+M32l2(j,h,c);
m3R1=M31r1(j,h,c)+M32r1(j,h,c);
if (j<1/h-1)
    m3R2=M31r2(j,h,c)+M32r2(j,h,c);
end
res=[m3L1, m3L2,m3R1, m3R2];
end

%
function m31l1=M31l1(j,h,c)
m31l1=(1/2).*h.*(6060+(-30).*h.*((-279)+808.*j)+10.*h.^2.*((-98)+(-2511) ...
  .*j+3636.*j.^2)+(-5).*h.^3.*(53+(-392).*j+(-5022).*j.^2+4848.* ...
  j.^3)+h.^4.*(612+265.*j+(-980).*j.^2+(-8370).*j.^3+6060.*j.^4))+( ...
  -30).*((-1)+h.*j).^4.*((-101)+h.*((-160)+101.*j)).*log(1+(-1).*h.* ...
  j)+900.*((-1)+h.*((-2)+j)).*((-1)+h.*j).^4.*log(1+(-1).*h.*j).^2+ ...
  30.*((-1)+h.*((-1)+j)).^3.*(101+(-1).*h.*(83+202.*j)+h.^2.*(36+ ...
  83.*j+101.*j.^2)).*log(1+h+(-1).*h.*j)+(-900).*((-1)+h.*((-1)+j)) ...
  .^2.*((-1)+3.*h.*j+h.^2.*(1+(-3).*j.^2)+h.^3.*(4+(-1).*j+j.^3)).* ...
  log(1+h+(-1).*h.*j).^2;
end
% 
function m31l2=M31l2(j,h,c)
m31l2=(-1/2).*h.*(6060+(-30).*h.*(231+808.*j)+10.*h.^2.*((-1673)+2079.* ...
  j+3636.*j.^2)+(-5).*h.^3.*(353+(-6692).*j+4158.*j.^2+4848.*j.^3)+ ...
  h.^4.*((-1113)+1765.*j+(-16730).*j.^2+6930.*j.^3+6060.*j.^4))+30.* ...
  ((-1)+h.*j).^3.*(101+(-1).*h.*(95+202.*j)+h.^2.*((-300)+95.*j+ ...
  101.*j.^2)).*log(1+(-1).*h.*j)+(-900).*((-1)+h.*j).^3.*(1+(-1).* ...
  h.*(1+2.*j)+h.^2.*((-6)+j+j.^2)).*log(1+(-1).*h.*j).^2+(-30).*(( ...
  -1)+h.*((-1)+j)).^2.*((-101)+3.*h.*(79+101.*j)+h.^2.*(17+(-474).* ...
  j+(-303).*j.^2)+h.^3.*(39+(-17).*j+237.*j.^2+101.*j.^3)).*log(1+h+ ...
  (-1).*h.*j)+900.*((-1)+h.*((-1)+j)).^2.*((-1)+3.*h.*(1+j)+h.^2.*( ...
  1+(-6).*j+(-3).*j.^2)+h.^3.*(1+(-1).*j+3.*j.^2+j.^3)).*log(1+h+( ...
  -1).*h.*j).^2;
end
% 
function m31r1=M31r1(j,h,c)
m31r1=(-1/2).*h.*(6060+(-30).*h.*(849+808.*j)+10.*h.^2.*(4027+7641.*j+ ...
  3636.*j.^2)+(-5).*h.^3.*(5647+16108.*j+15282.*j.^2+4848.*j.^3)+ ...
  h.^4.*(7087+28235.*j+40270.*j.^2+25470.*j.^3+6060.*j.^4))+(-30).*( ...
  (-101)+5.*h.*(89+101.*j)+(-10).*h.^2.*(74+178.*j+101.*j.^2)+10.* ...
  h.^3.*(54+222.*j+267.*j.^2+101.*j.^3)+(-5).*h.^4.*(24+216.*j+444.* ...
  j.^2+356.*j.^3+101.*j.^4)+h.^5.*j.*(120+540.*j+740.*j.^2+445.* ...
  j.^3+101.*j.^4)).*log(1+(-1).*h.*j)+900.*((-1)+5.*h.*(1+j)+(-10).* ...
  h.^2.*(1+j).^2+2.*h.^3.*(2+15.*j+15.*j.^2+5.*j.^3)+h.^5.*j.*(2+4.* ...
  j+10.*j.^2+5.*j.^3+j.^4)+(-1).*h.^4.*(2+8.*j+30.*j.^2+20.*j.^3+5.* ...
  j.^4)).*log(1+(-1).*h.*j).^2+3030.*((-1)+h+h.*j).^5.*log(1+(-1).* ...
  h.*(1+j))+(-900).*((-1)+h+h.*j).^5.*log(1+(-1).*h.*(1+j)).^2;
end
% 
function m31r2=M31r2(j,h,c)
m31r2=(1/2).*h.*(6060+(-30).*h.*(1359+808.*j)+10.*h.^2.*(8842+12231.*j+ ...
  3636.*j.^2)+(-5).*h.^3.*(15667+35368.*j+24462.*j.^2+4848.*j.^3)+ ...
  h.^4.*(25012+78335.*j+88420.*j.^2+40770.*j.^3+6060.*j.^4))+30.*(( ...
  -101)+h.*(700+505.*j)+(-10).*h.^2.*(158+280.*j+101.*j.^2)+10.* ...
  h.^3.*(144+474.*j+420.*j.^2+101.*j.^3)+(-5).*h.^4.*(96+576.*j+ ...
  948.*j.^2+560.*j.^3+101.*j.^4)+h.^5.*j.*(480+1440.*j+1580.*j.^2+ ...
  700.*j.^3+101.*j.^4)).*log(1+(-1).*h.*j)+(-900).*((-1)+h.*(8+5.*j) ...
  +(-2).*h.^2.*(11+16.*j+5.*j.^2)+2.*h.^3.*(11+33.*j+24.*j.^2+5.* ...
  j.^3)+h.^5.*j.*(8+22.*j+22.*j.^2+8.*j.^3+j.^4)+(-1).*h.^4.*(8+44.* ...
  j+66.*j.^2+32.*j.^3+5.*j.^4)).*log(1+(-1).*h.*j).^2+(-30).*((-1)+ ...
  h+h.*j).^4.*((-101)+h.*(356+101.*j)).*log(1+(-1).*h.*(1+j))+900.*( ...
  (-1)+h+h.*j).^4.*((-1)+h.*(4+j)).*log(1+(-1).*h.*(1+j)).^2;
end

%
function m32l1=M32l1(j,h,c)
m32l1=(1/2).*h.*(6060+(-30).*h.*(551+808.*j)+10.*h.^2.*(247+4959.*j+ ...
  3636.*j.^2)+(-5).*h.^3.*((-87)+988.*j+9918.*j.^2+4848.*j.^3)+ ...
  h.^4.*(387+(-435).*j+2470.*j.^2+16530.*j.^3+6060.*j.^4))+(-30).*(( ...
  -1)+h.*j).^4.*((-101)+h.*(255+101.*j)).*log(1+(-1).*h.*j)+900.*(( ...
  -1)+h.*j).^4.*((-1)+h.*(3+j)).*log(1+(-1).*h.*j).^2+30.*((-101)+ ...
  5.*h.*(39+101.*j)+(-10).*h.^2.*((-21)+78.*j+101.*j.^2)+10.*h.^3.*( ...
  (-11)+(-63).*j+117.*j.^2+101.*j.^3)+(-5).*h.^4.*(9+(-44).*j+(-126) ...
  .*j.^2+156.*j.^3+101.*j.^4)+h.^5.*((-21)+45.*j+(-110).*j.^2+(-210) ...
  .*j.^3+195.*j.^4+101.*j.^5)).*log(1+h+(-1).*h.*j)+(-900).*((-1)+ ...
  h.*(3+5.*j)+(-2).*h.^2.*j.*(6+5.*j)+2.*h.^3.*((-3)+9.*j.^2+5.* ...
  j.^3)+(-1).*h.^4.*(3+(-12).*j+12.*j.^3+5.*j.^4)+h.^5.*((-1)+3.*j+( ...
  -6).*j.^2+3.*j.^4+j.^5)).*log(1+h+(-1).*h.*j).^2;
end
%
function m32l2=M32l2(j,h,c)
m32l2=(-1/2).*h.*(6060+(-30).*h.*(231+808.*j)+10.*h.^2.*((-1673)+2079.* ...
  j+3636.*j.^2)+(-5).*h.^3.*(353+(-6692).*j+4158.*j.^2+4848.*j.^3)+ ...
  h.^4.*((-1113)+1765.*j+(-16730).*j.^2+6930.*j.^3+6060.*j.^4))+30.* ...
  ((-1)+h.*j).^3.*(101+(-1).*h.*(95+202.*j)+h.^2.*((-300)+95.*j+ ...
  101.*j.^2)).*log(1+(-1).*h.*j)+(-900).*((-1)+h.*j).^3.*(1+(-1).* ...
  h.*(1+2.*j)+h.^2.*((-6)+j+j.^2)).*log(1+(-1).*h.*j).^2+(-30).*(( ...
  -1)+h.*((-1)+j)).^2.*((-101)+3.*h.*(79+101.*j)+h.^2.*(17+(-474).* ...
  j+(-303).*j.^2)+h.^3.*(39+(-17).*j+237.*j.^2+101.*j.^3)).*log(1+h+ ...
  (-1).*h.*j)+900.*((-1)+h.*((-1)+j)).^2.*((-1)+3.*h.*(1+j)+h.^2.*( ...
  1+(-6).*j+(-3).*j.^2)+h.^3.*(1+(-1).*j+3.*j.^2+j.^3)).*log(1+h+( ...
  -1).*h.*j).^2;
end
%
function m32r1=M32r1(j,h,c)
m32r1=(-1/2).*h.*(6060+(-30).*h.*(849+808.*j)+10.*h.^2.*(4027+7641.*j+ ...
  3636.*j.^2)+(-5).*h.^3.*(5647+16108.*j+15282.*j.^2+4848.*j.^3)+ ...
  h.^4.*(7087+28235.*j+40270.*j.^2+25470.*j.^3+6060.*j.^4))+(-30).*( ...
  (-101)+5.*h.*(89+101.*j)+(-10).*h.^2.*(74+178.*j+101.*j.^2)+10.* ...
  h.^3.*(54+222.*j+267.*j.^2+101.*j.^3)+(-5).*h.^4.*(24+216.*j+444.* ...
  j.^2+356.*j.^3+101.*j.^4)+h.^5.*j.*(120+540.*j+740.*j.^2+445.* ...
  j.^3+101.*j.^4)).*log(1+(-1).*h.*j)+900.*((-1)+5.*h.*(1+j)+(-10).* ...
  h.^2.*(1+j).^2+2.*h.^3.*(2+15.*j+15.*j.^2+5.*j.^3)+h.^5.*j.*(2+4.* ...
  j+10.*j.^2+5.*j.^3+j.^4)+(-1).*h.^4.*(2+8.*j+30.*j.^2+20.*j.^3+5.* ...
  j.^4)).*log(1+(-1).*h.*j).^2+3030.*((-1)+h+h.*j).^5.*log(1+(-1).* ...
  h.*(1+j))+(-900).*((-1)+h+h.*j).^5.*log(1+(-1).*h.*(1+j)).^2;
end
%
function m32r2=M32r2(j,h,c)
m32r2=(1/2).*h.*(6060+(-30).*h.*(529+808.*j)+10.*h.^2.*(1027+4761.*j+ ...
  3636.*j.^2)+(-5).*h.^3.*((-513)+4108.*j+9522.*j.^2+4848.*j.^3)+ ...
  h.^4.*((-2413)+(-2565).*j+10270.*j.^2+15870.*j.^3+6060.*j.^4))+ ...
  30.*((-1)+h.*j).^3.*(101+(-1).*h.*(285+202.*j)+h.^2.*(220+285.*j+ ...
  101.*j.^2)).*log(1+(-1).*h.*j)+(-900).*((-1)+h.*j).^2.*((-1)+3.* ...
  h.*(1+j)+(-1).*h.^2.*(2+6.*j+3.*j.^2)+h.^3.*(4+2.*j+3.*j.^2+j.^3)) ...
  .*log(1+(-1).*h.*j).^2+(-30).*((-1)+h+h.*j).^4.*((-101)+h.*((-59)+ ...
  101.*j)).*log(1+(-1).*h.*(1+j))+900.*((-1)+h.*((-1)+j)).*((-1)+h+ ...
  h.*j).^4.*log(1+(-1).*h.*(1+j)).^2;
end
%